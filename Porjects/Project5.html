<!DOCTYPE html>
<html>
<head>
    <title>180 Proj5</title>
    <link rel="stylesheet" href="../styles.css"> 
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <nav>
        <a href="#Part1">Part A: The Power of Diffusion Models!</a>
    </nav>
 
    <header><h1>Project 5</h1>
        <h2>Fun With Diffusion Models!</h2>
        <h3> Siyuan Zhai</h3>
    </header>

    <div class = 'content-container'>
    
        <section id = 'Part1'>
            <h2> Part A: The Power of Diffusion Models! </h2>
            <h3> Overview</h3>
            <p>In this part, I tried to implement diffusion sampling loops, 
                and use them for other tasks such as inpainting and creating optical illusions.
            </p>

            <h2>Sampling Loops</h2>
            <h3>1.0: Setup</h3>
            <p>
                In this part, I set up the environment and load the necessary libraries and models. 
                Download the precomputed Text embedding model and the pretrained diffusion model. And try sampling from the diffusion model with seed 180.
                Output images are shown below.
            </p>
            <div class = "gallery">
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_1_output_0.jpg">
                    <div class="content-title">an oil painting of a snowy mountain village, stage1, num_inference_steps = 60</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_1_output_1.jpg">
                    <div class="content-title">a man wearing a hat, stage1,  num_inference_steps = 60</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_1_output_2.jpg">
                    <div class="content-title">a rocket ship, stage1,  num_inference_steps = 60</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_2_output_0.jpg">
                    <div class="content-title">an oil painting of a snowy mountain village, stage2, num_inference_steps = 60</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_2_output_1.jpg">
                    <div class="content-title">a man wearing a hat, stage2,  num_inference_steps = 60</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_2_output_2.jpg">
                    <div class="content-title">a rocket ship, stage2,  num_inference_steps = 60</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_2_output_numstep120_0.jpg">
                    <div class="content-title">an oil painting of a snowy mountain village, stage2, num_inference_steps = 240</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_2_output_numstep120_1.jpg">
                    <div class="content-title">a man wearing a hat, stage2,  num_inference_steps = 240</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/stage_2_output_numstep120_2.jpg">
                    <div class="content-title">a rocket ship, stage2,  num_inference_steps = 240</div>
                </div>
            </div>
            <p>
                As we can see, the model can generate a wide variety of images, from oil paintings to rocket ships base on the prompt_embeds,
                and the images are generated in two stages. The first stage generates a rough sketch of the image, while the second stage refines the sketch to create a more detailed image.
                And num_inference_steps is the number of steps to run the model for each stage. The higher the number, the more detailed and smoother the image will be.
            </p>

            <h3>1.1 Implementing the Forward Process</h3>           
            <p>
                In this part, we implement the forward process of the diffusion model.
                Start with a clean image, we add noise to it at each time step to create a noisy image based on the equation:
                \( x_t = \sqrt{\bar{\alpha}_t} x_0 + \sqrt{1 - \bar{\alpha}_t} \epsilon \quad \text{where}~ \epsilon \sim N(0, 1) \tag{2} \)
            <p>
                We use alphas_cumprod variable that include an array of hyperaparameters, and alphas_cumprod[t] is the value of \( \bar{\alpha}_t \) at timestep t.
            </p>
            <h3>Outputs</h3>
            <div class = "gallery">
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_noisy250.jpg">
                    <div class="content-title">noisyimg, t = 250</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_noisy500.jpg">
                    <div class="content-title">noisyimg, t = 500</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_noisy750.jpg">
                    <div class="content-title">noisyimg, t = 750</div>
                </div>
            </div>

             
            <h3>1.2: Classical Denoising </h3>
            <p> 
                After implementing the forward process, I use classical denoising methods to denoise the images.
                First take noise image for timesteps [250,500,750], use Gaussian blur to denoise the images. The resulte is shown below.
            </p>
            <div class = "gallery">
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_gauss250.jpg">
                    <div class="content-title">Classical Denoising, t = 250</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_gauss500.jpg">
                    <div class="content-title">Classical Denoising, t = 500</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_gauss750.jpg">
                    <div class="content-title">Classical Denoising, t = 750</div>
                </div>
            </div>

            <h3>1.3 One-Step Denoising</h3>
            <p>
                In this step, UNet is used to denoise images by first identifying and recovering the Gaussian noise present and then removing it to approximate the original, noise-free image.
                Since the diffusion model uses text conditioning, we can use the prompt_embeds = "a high quality photo" to guide the denoising process.
                The result is shown below.
            </p>
            <div class = 'gallery'>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/testimg.jpg.jpg">
                    <div class="content-title">original image</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_noisy250.jpg">
                    <div class="content-title">noisyimg, t = 250</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_noisy500.jpg">
                    <div class="content-title">noisyimg, t = 500</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/img3_noisy750.jpg">
                    <div class="content-title">noisyimg, t = 750</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_est_3250.jpg">
                    <div class="content-title">UNet Denoising, t = 250</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_est_3500.jpg">
                    <div class="content-title">UNet Denoising, t = 500</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_est_3750.jpg">
                    <div class="content-title">UNet Denoising, t = 750</div>
                </div>
            </div>
            
            <h3>1.4: Iterative Denoising</h3>
            <p> 

                Denoising UNet does better than classical denoising methods. To get a better result, I use iterative denoising.
                We start with a noisy image \( x_{1000} \) at timestep 1000. 
                Normally, we would denoise this step-by-stepâ€”going from \( x_{1000} \) to \( x_{999} \), then \( x_{998} \), and so forth. 
                However, this approach can be slow and computationally intensive.
                One way to reduce the time is to create a list of timesteps called `strided_timesteps` that skips certain steps. 
                This allows us to apply the diffusion model at specific intervals, making the denoising process more efficient.
            </p>
            <p>
                The iterative denoising process can be described by the following equation:
                \[
                x_{t'} = \frac{\sqrt{\bar{\alpha}_{t'}}\beta_t}{1 - \bar{\alpha}_t} x_0 +
                \frac{\sqrt{\alpha_t}(1 - \bar{\alpha}_{t'})}{1 - \bar{\alpha}_t} x_t +
                v_\sigma \tag{3}
                \]
            </p>
            <p>
                Here, \( x_t \) is the image at timestep \( t \), and \( x_{t'} \) is the denoised image at timestep \( t' \). By using this equation, we can gradually reduce noise at each selected timestep, efficiently bringing the image closer to its original form.
            </p>
            <div class = 'gallery'>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/noisy_image_14.jpg">
                    <div class="content-title">noisyimg, strided_timesteps[10]</div>
                </div>

                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_0.0.jpg">
                    <div class="content-title">First 5th loop</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_1.0.jpg">
                    <div class="content-title">second 5th loop</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_2.0.jpg">
                    <div class="content-title">third 5th loop</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_3.0.jpg">
                    <div class="content-title">fourth 5th loop</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_4.0.jpg">
                    <div class="content-title">fifth 5th loop</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_5.0.jpg">
                    <div class="content-title">sixth 5th loop</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_6.0.jpg">
                    <div class="content-title">seventh 5th loop</div>
                </div>  
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_image_4.jpg">
                    <div class="content-title">Final clean image</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/clean_one_step_image_4.jpg">
                    <div class="content-title">One step clean image</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/blur_filtered_image_4.jpg">
                    <div class="content-title"> gaussian blurring clean image</div>
                </div>
            </div>

            <h3>1.5 Diffusion Model Sampling</h3>
            <p>
                In previous sections, we used the diffusion model to denoise images. Now, we will use the model to generate new images by setting i_start = 0.
                Means start from a pure noise image, and generate images based on the prompt_embeds = "a high quality photo".
            </p>
            <div class = "gallery">
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample5_1.jpg">
                    <div class="content-title">Sample img</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample5_2.jpg">
                    <div class="content-title">Sample img</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample5_3.jpg">
                    <div class="content-title">Sample img</div>
                </div>
                <div class= "gallery-item">
                    <img src="../src/proj5_output/sample5_4.jpg">
                    <div class="content-title">Sample img</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample5_5.jpg">
                    <div class="content-title">Sample img</div>
                </div>
            </div>
            <h3>1.6 Classifier-Free Guidance (CFG)</h3>
            <p> 
                Some of the images generated by Diffusion Model are meaning less, to improve the image quality, we can use Classifier-Free Guidance (CFG) to guide the sampling process. 
                Basically, we compute the conditional nosie and unconditional noise, sum them with a scaling factor(7), and use the result to guide the sampling process.
                Output images are shown below.
            </p>
            <div class = "gallery">
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample6_1.jpg">
                    <div class="content-title">Sample img</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample6_2.jpg">
                    <div class="content-title">Sample img</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample6_3.jpg">
                    <div class="content-title">Sample img</div>
                </div>
                <div class= "gallery-item">
                    <img src="../src/proj5_output/sample6_4.jpg">
                    <div class="content-title">Sample img</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/sample6_5.jpg">
                    <div class="content-title">Sample img</div>
                </div>
            </div>

            <h3>1.7 Image-to-image Translation</h3>
            <p>
                By applying a small amount of noise initially, the denoised image will closely resemble the original, enabling subtle edits. This iterative process, guided by the SDEdit algorithm, gradually refines the image back towards its original state, allowing for controlled modifications.
                Next, we will experiment with different levels of noise by using starting indices of [1, 3, 5, 7, 10, 20]. This will produce a series of progressively "edited" images, with each step bringing the noisy image closer to its original form. The resulting output images are displayed below.

            </p>
            <div class = 'gallery'>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/sample7_1.jpg">
                    <div class="content-title">Sample img, i = 1</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/sample7_3.jpg">
                    <div class="content-title">Sample img, i = 3</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/sample7_5.jpg">
                    <div class="content-title">Sample img, i = 5</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/sample7_7.jpg">
                    <div class="content-title">Sample img, i = 7</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/sample7_10.jpg">
                    <div class="content-title">Sample img, i = 10</div>
                </div>
                <div class = 'gallery-item'>
                    <img src="../src/proj5_output/sample7_20.jpg">
                    <div class="content-title">Sample img, i = 20</div>
                </div>
            </div>
            <p>
                If we start from some unrealistic images, the denoising process will help us turn it to a more realistic image.
                Output images are shown below.
            </p>
            <div class="gallery">
                <div class = "gallery-item">
                    <img src="https://i.pinimg.com/736x/a4/21/15/a421153d9664a572b1b1269e95231474.jpg">
                    <div class="content-title">Web_Image</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Web_Images1_1.jpg">
                    <div class="content-title">Web_Images1, i = 1</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Web_Images1_3.jpg">
                    <div class="content-title">Web_Images1, i = 3</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Web_Images1_5.jpg">
                    <div class="content-title">Web_Images1, i = 5</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Web_Images1_7.jpg">
                    <div class="content-title">Web_Images1, i = 7</div>
                </div>   
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Web_Images1_10.jpg">
                    <div class="content-title">Web_Images1, i = 10</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Web_Images1_20.jpg">
                    <div class="content-title">Web_Images1, i = 20</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/drawn_image1.jpg">
                    <div class="content-title">Hand_drawn1</div>
                </div>

                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn1_1.jpg">
                    <div class="content-title">Hand_drawn1, i = 1</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn1_3.jpg">
                    <div class="content-title">Hand_drawn1, i = 3</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn1_5.jpg">
                    <div class="content-title">Hand_drawn1, i = 5</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn1_7.jpg">
                    <div class="content-title">Hand_drawn1, i = 7</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn1_10.jpg">
                    <div class="content-title">Hand_drawn1, i = 10</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn1_20.jpg">
                    <div class="content-title">Hand_drawn1, i = 20</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/drawn_image2.jpg">
                    <div class="content-title">Hand_drawn2</div>
                </div>

                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn2_1.jpg">
                    <div class="content-title">Hand_drawn2, i = 1</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn2_3.jpg">
                    <div class="content-title">Hand_drawn2, i = 3</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn2_5.jpg">
                    <div class="content-title">Hand_drawn2, i = 5</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn2_7.jpg">
                    <div class="content-title">Hand_drawn2, i = 7</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn2_10.jpg">
                    <div class="content-title">Hand_drawn2, i = 10</div>
                </div>
                <div class = "gallery-item">
                    <img src="../src/proj5_output/Hand_drawn2_20.jpg">
                    <div class="content-title">Hand_drawn2, i = 20</div>
                </div>
            </div>
        <h3> 1.7.2 inpainting</h3>
        <p>
            In this part, I use the diffusion model to inpaint images. 
            I start with a clean image, and mask out a portion of the image. 
            Then, I use the diffusion model to inpaint the masked region.
            The result is shown below.
        </p>
        <div class = "gallery">
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting11.jpg">
                <div class="content-title">Inpainting1</div>
            </div>   
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting12.jpg">
                <div class="content-title">Inpainting1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting13.jpg">
                <div class="content-title">Inpainting1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting14.jpg">
                <div class="content-title">Inpainting1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting15.jpg">
                <div class="content-title">Inpainting1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting21.jpg">
                <div class="content-title">Inpainting2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting22.jpg">
                <div class="content-title">Inpainting2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting23.jpg">
                <div class="content-title">Inpainting2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting24.jpg">
                <div class="content-title">Inpainting2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting25.jpg">
                <div class="content-title">Inpainting2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting31.jpg">
                <div class="content-title">Inpainting3</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting32.jpg">
                <div class="content-title">Inpainting3</div>
            </div>
            <div 
                class = "gallery-item">
                <img src="../src/proj5_output/inpainting33.jpg">
                <div class="content-title">Inpainting3</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/inpainting34.jpg">
                <div class="content-title">Inpainting3</div>
            </div>
            <div
                class = "gallery-item">
                <img src="../src/proj5_output/inpainting35.jpg">
                <div class="content-title">Inpainting3</div>
            </div>
        </div>
        <h3>1.7.3 Text-Conditioned Image-to-image Translation</h3>
        <p>
            In this part, I use the diffusion model to perform text-conditioned image-to-image translation.
            I start with a clean image, add some noise, and use the prompt_embeds = "a high quality photo" to guide the translation process.
            The result is shown below.
        </p>
        <div class = "gallery">
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_1.jpg">
                <div class="content-title">Translation1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_3.jpg">
                <div class="content-title">Translation1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_5.jpg">
                <div class="content-title">Translation1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_7.jpg">
                <div class="content-title">Translation1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_10.jpg">
                <div class="content-title">Translation1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_20.jpg">
                <div class="content-title">Translation1</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_2_1.jpg">
                <div class="content-title">Translation2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_2_3.jpg">
                <div class="content-title">Translation2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_2_5.jpg">
                <div class="content-title">Translation2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_2_7.jpg">
                <div class="content-title">Translation2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_2_10.jpg">
                <div class="content-title">Translation2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_2_20.jpg">
                <div class="content-title">Translation2</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_3_1.jpg">
                <div class="content-title">Translation3</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_3_3.jpg">
                <div class="content-title">Translation3</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_3_5.jpg">
                <div class="content-title">Translation3</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_3_7.jpg">
                <div class="content-title">Translation3</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_3_10.jpg">
                <div class="content-title">Translation3</div>
            </div>
            <div class = "gallery-item">
                <img src="../src/proj5_output/sample173_3_20.jpg">
                <div class="content-title">Translation3</div>
            </div>
        </div>

    <h3>1.8 Visual Anagrams</h3>
    <p>
        In this part, we start with a imaage x_t at step t, with promot "an oil painting of an old man", to get 
        the noise, also, flip the image upside down denoise with different promote "an oil painting of people around a campfire", then flip the image back to get the noise estimate.
        algorithm  and ouput images are shown below.
    </p>
    <p>
        \( \epsilon_1 = \text{UNet}(x_t, t, p_1) \)
    </p>
    <p>
        \( \epsilon_2 = \text{flip}(\text{UNet}(\text{flip}(x_t), t, p_2)) \)
    </p>
    <p>
        \( \epsilon = (\epsilon_1 + \epsilon_2) / 2 \)
    </p>
    <div class = "gallery">
        <div class = "gallery-item">
            <img src="../src/proj5_output/sample8_10.jpg">
            <div class="content-title">an oil painting of an old man</div>
        </div>

        <div class = "gallery-item">
            <img src="../src/proj5_output/sample8_flipped_10.jpg">
            <div class="content-title">An oil painting of people around a campfire</div>
        </div>
        <div class = "gallery-item">
            <img src="../src/proj5_output/sample8_11.jpg">
            <div class="content-title">an oil painting of an old man</div>
        </div>
        <div class = "gallery-item">
            <img src="../src/proj5_output/sample8_flipped_11.jpg">
            <div class="content-title">an oil painting of people around a campfire</div>div>
        </div>

        <div class = "gallery-item">
            <img src="../src/proj5_output/sample82_5.jpg">
            <div class="content-title">a photo of a dog</div>
        </div>
        <div class = "gallery-item">
            <img src="../src/proj5_output/sample82_flipped_5.jpg">
            <div class="content-title">an oil painting of people around a campfire</div>
        </div>

        <div class = "gallery-item">
            <img src="../src/proj5_output/sample82_11.jpg">
            <div class="content-title">a photo of a dog</div>
        </div>
        
        <div class = "gallery-item">
            <img src="../src/proj5_output/sample82_flipped_11.jpg">
            <div class="content-title">an oil painting of people around a campfire</div>
        </div>
    </div>

    <h3>1.9 Hybrid Images</h3>
    <p>Similar to the previous part, we start with an image \( x_t \) at step \( t \), 
        using the prompt "a lithograph of waterfalls" for high-frequency noise and "a blurry photo of a skull" for low-frequency noise.</p>
    <p>Here is the algorithm:</p>
    <p>
        \( \epsilon_1 = \text{UNet}(x_t, t, p_1) \)
    </p>
    <p>
        \( \epsilon_2 = \text{UNet}(x_t, t, p_2) \)
    </p>
    <p>
        \( \epsilon = f_{\text{lowpass}}(\epsilon_1) + f_{\text{highpass}}(\epsilon_2) \)
    </p>

    <div class = 'gallery'>
        <div class = 'gallery-item'>
            <img src="../src/proj5_output/sample10_1.jpg">
            <div class="content-title">a lithograph of a skull & a lithograph of waterfalls</div>
        </div>
        <div class = 'gallery-item'>
            <img src="../src/proj5_output/sample10_3.jpg">
            <div class="content-title">a lithograph of a skull & a lithograph of waterfalls</div>
        </div>

        <div class = 'gallery-item'>
            <img src="../src/proj5_output/sample10_1_1.jpg">
            <div class="content-title">a lithograph of a skull & a photo of the amalfi cost</div>
        </div>
        <div class = 'gallery-item'>
            <img src="../src/proj5_output/sample10_1_3.jpg">
            <div class="content-title">a lithograph of a skull & a photo of the amalfi cost</div>
        </div>

        <div class = 'gallery-item'>
            <img src="../src/proj5_output/sample10_2_5.jpg">
            <div class="content-title">a lithograph of a skull & a photo of the amalfi cost </div>
        </div>
        <div class = 'gallery-item'>
            <img src="../src/proj5_output/sample10_2_7.jpg">
            <div class="content-title">a lithograph of a skull & a photo of the amalfi cost</div>
        </div>
    </div>

    </section>
       
    <div class="footer">
        <p> Asked ChateGPT to generate some text in this page: https://chatgpt.com/share/671198a5-93ec-8007-9e1e-a4d8aec966ee,<br> and https://chatgpt.com/share/671b40d0-c234-8007-80d6-b468d1853130.
           </p>
        
    </div>
</body>

</html>